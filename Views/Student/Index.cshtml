@model IEnumerable<SchoolPortal.Models.Student>

@{
	ViewBag.Title = "Students";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<br />
<h2>Students</h2>

<table id="students" class="table table-bordered table-hover">
	<thead>
		<tr>
			<th><b> Name</b></th>

			<th><b>Class</b></th>
			<th><b>Gender</b></th>
			<th><b>Select Action</b></th>
		</tr>
	</thead>

	<tbody>
		@foreach (var students in Model)
		{
			<tr>
				<td>@students.FirstName @students.MiddleName  @students.Lastname</td>
				<td>@students.Year.YearName</td>
				<td>@students.Gender.Name</td>

				<td>
					<div class="btn-group">
						<a href="#" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
							Select Action
							<span class="caret"></span>
						</a>
						<ul class="dropdown-menu">
							<li>@Html.ActionLink("View Details", "Details", "Student", new { id = students.Id }, null)</li>
							<li>@Html.ActionLink("Edit Student", "Edit", "Student", new { id = students.Id }, null)</li>
							<li>@Html.ActionLink("Delete Student", "Delete", "Student", new { id = students.Id }, null)</li>
							<li data-student-id="@students.Id" class="active btn-link js-delete">Remove</li>
						</ul>
					</div>
				</td>
			</tr>
		}
	</tbody>
</table>

@section scripts
	{
	<script>
		$(document).ready(function () {
			$("#students").DataTable();
			$("#students").on("click", "js-delete", function () {
				var button = $(this);
				bootbox.confirm("Are you sure you want to delete this student?", function (result) {
					if (result) {
						$.ajax({
							url: "/api/students/" + button.attr("data-student-id"),
							method: "DELETE",
							success: function () {
								button.parents("tr").remove();
							}

						});

					}
				});
				

			});
		});
	</script>

}